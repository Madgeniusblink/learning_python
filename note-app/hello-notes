New file function is working fine